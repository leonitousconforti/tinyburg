/**
 * @since 1.0.0
 * @category Bitizens
 */

import type * as Effect from "effect/Effect";
import type * as SchemaAST from "effect/SchemaAST";

import * as NimblebitSchema from "@tinyburg/nimblebit-sdk/NimblebitSchema";
import * as Array from "effect/Array";
import * as Either from "effect/Either";
import * as Function from "effect/Function";
import * as Option from "effect/Option";
import * as ParseResult from "effect/ParseResult";
import * as Record from "effect/Record";
import * as Schema from "effect/Schema";

import * as Costumes from "./Costumes.ts";
import * as Pets from "./Pets.ts";

//////////////////////////////////////////////////////////////////

/**
 * This file was auto-generated by a frida agent.
 *
 * Generated On: Tue, 13 Jan 2026 19:07:54 GMT
 *
 * With Tiny Tower Version: 7.2.0
 */

export const numberBiHats = 17 as const;
export const numberFemaleHats = 2 as const;
export const numberGlasses = 9 as const;
export const numberHairAccessories = 3 as const;
export const numberMaleHats = 1 as const;

export const maleNames = [
    "mary",
    "patricia",
    "linda",
    "barbara",
    "elizabeth",
    "jennifer",
    "maria",
    "susan",
    "margaret",
    "dorothy",
    "lisa",
    "nancy",
    "karen",
    "betty",
    "helen",
    "sandra",
    "donna",
    "carol",
    "ruth",
    "sharon",
    "michelle",
    "laura",
    "sarah",
    "kimberly",
    "deborah",
    "jessica",
    "shirley",
    "cynthia",
    "angela",
    "melissa",
    "brenda",
    "amy",
    "anna",
    "rebecca",
    "virginia",
    "kathleen",
    "pamela",
    "martha",
    "debra",
    "amanda",
    "stephanie",
    "carolyn",
    "christine",
    "marie",
    "janet",
    "catherine",
    "frances",
    "ann",
    "joyce",
    "diane",
    "alice",
    "julie",
    "heather",
    "teresa",
    "doris",
    "gloria",
    "evelyn",
    "jean",
    "cheryl",
    "mildred",
    "katherine",
    "joan",
    "ashley",
    "judith",
    "rose",
    "janice",
    "kelly",
    "nicole",
    "judy",
    "christina",
    "kathy",
    "theresa",
    "beverly",
    "denise",
    "tammy",
    "irene",
    "jane",
    "lori",
    "rachel",
    "marilyn",
    "andrea",
    "kathryn",
    "louise",
    "sara",
    "anne",
    "jacqueline",
    "wanda",
    "bonnie",
    "julia",
    "ruby",
    "lois",
    "tina",
    "phyllis",
    "norma",
    "paula",
    "diana",
    "annie",
    "lillian",
    "emily",
    "robin",
    "peggy",
    "crystal",
    "gladys",
    "rita",
    "dawn",
    "connie",
    "florence",
    "tracy",
    "edna",
    "tiffany",
    "carmen",
    "rosa",
    "cindy",
    "grace",
    "wendy",
    "victoria",
    "edith",
    "kim",
    "sherry",
    "sylvia",
    "josephine",
    "thelma",
    "shannon",
    "sheila",
    "ethel",
    "ellen",
    "elaine",
    "marjorie",
    "carrie",
    "charlotte",
    "monica",
    "esther",
    "pauline",
    "emma",
    "juanita",
    "anita",
    "rhonda",
    "hazel",
    "amber",
    "eva",
    "debbie",
    "april",
    "leslie",
    "clara",
    "lucille",
    "jamie",
    "joanne",
    "eleanor",
    "valerie",
    "danielle",
    "megan",
    "alicia",
    "suzanne",
    "michele",
    "gail",
    "bertha",
    "darlene",
    "veronica",
    "jill",
    "erin",
    "geraldine",
    "lauren",
    "cathy",
    "joann",
    "lorraine",
    "lynn",
    "sally",
    "regina",
    "erica",
    "beatrice",
    "dolores",
    "bernice",
    "audrey",
    "yvonne",
    "annette",
    "june",
    "samantha",
    "marion",
    "dana",
    "stacy",
    "ana",
    "renee",
    "ida",
    "vivian",
    "roberta",
    "holly",
    "brittany",
    "melanie",
    "loretta",
    "yolanda",
    "jeanette",
    "laurie",
    "katie",
    "kristen",
    "vanessa",
    "alma",
    "sue",
    "elsie",
    "beth",
    "jeanne",
    "vicki",
    "carla",
    "tara",
    "rosemary",
    "eileen",
    "terri",
    "gertrude",
    "lucy",
    "tonya",
    "ella",
    "stacey",
    "wilma",
    "gina",
    "kristin",
    "jessie",
    "natalie",
    "agnes",
    "vera",
    "willie",
    "charlene",
    "bessie",
    "delores",
    "melinda",
    "pearl",
    "arlene",
    "maureen",
    "colleen",
    "allison",
    "tamara",
    "joy",
    "georgia",
    "constance",
    "lillie",
    "claudia",
    "jackie",
    "marcia",
    "tanya",
    "nellie",
    "minnie",
    "marlene",
    "heidi",
    "glenda",
    "lydia",
    "viola",
    "courtney",
    "marian",
    "stella",
    "caroline",
    "dora",
    "jo",
    "vickie",
    "mattie",
    "terry",
    "maxine",
    "irma",
    "mabel",
    "marsha",
    "myrtle",
    "lena",
    "christy",
    "deanna",
    "patsy",
    "hilda",
    "gwendolyn",
    "jennie",
    "nora",
    "margie",
    "nina",
    "cassandra",
    "leah",
    "penny",
    "kay",
    "priscilla",
    "naomi",
    "carole",
    "brandy",
    "olga",
    "billie",
    "dianne",
    "tracey",
    "leona",
    "jenny",
    "felicia",
    "sonia",
    "miriam",
    "velma",
    "becky",
    "bobbie",
    "violet",
    "kristina",
    "toni",
    "misty",
    "mae",
    "shelly",
    "daisy",
    "ramona",
    "sherri",
    "erika",
    "katrina",
    "claire",
] as const;

export const maleLastNames = [
    "smith",
    "johnson",
    "williams",
    "jones",
    "brown",
    "davis",
    "miller",
    "wilson",
    "moore",
    "taylor",
    "anderson",
    "thomas",
    "jackson",
    "white",
    "harris",
    "martin",
    "thompson",
    "garcia",
    "martinez",
    "robinson",
    "clark",
    "rodriguez",
    "lewis",
    "lee",
    "walker",
    "hall",
    "allen",
    "young",
    "hernandez",
    "king",
    "wright",
    "lopez",
    "hill",
    "scott",
    "green",
    "adams",
    "baker",
    "gonzalez",
    "nelson",
    "carter",
    "mitchell",
    "perez",
    "roberts",
    "turner",
    "phillips",
    "campbell",
    "parker",
    "evans",
    "edwards",
    "collins",
    "stewart",
    "sanchez",
    "morris",
    "rogers",
    "reed",
    "cook",
    "morgan",
    "bell",
    "murphy",
    "bailey",
    "rivera",
    "cooper",
    "richardson",
    "cox",
    "howard",
    "ward",
    "torres",
    "peterson",
    "gray",
    "ramirez",
    "james",
    "watson",
    "brooks",
    "kelly",
    "sanders",
    "price",
    "bennett",
    "wood",
    "barnes",
    "ross",
    "henderson",
    "coleman",
    "jenkins",
    "perry",
    "powell",
    "long",
    "patterson",
    "hughes",
    "flores",
    "washington",
    "butler",
    "simmons",
    "foster",
    "gonzales",
    "bryant",
    "alexander",
    "russell",
    "griffin",
    "diaz",
    "hayes",
    "myers",
    "ford",
    "hamilton",
    "graham",
    "sullivan",
    "wallace",
    "woods",
    "cole",
    "west",
    "jordan",
    "owens",
    "reynolds",
    "fisher",
    "ellis",
    "harrison",
    "gibson",
    "mcdonald",
    "cruz",
    "marshall",
    "ortiz",
    "gomez",
    "murray",
    "freeman",
    "wells",
    "webb",
    "simpson",
    "stevens",
    "tucker",
    "porter",
    "hunter",
    "hicks",
    "crawford",
    "henry",
    "boyd",
    "mason",
    "morales",
    "kennedy",
    "warren",
    "dixon",
    "ramos",
    "reyes",
    "burns",
    "gordon",
    "shaw",
    "holmes",
    "rice",
    "robertson",
    "hunt",
    "black",
    "daniels",
    "palmer",
    "mills",
    "nichols",
    "grant",
    "knight",
    "ferguson",
    "rose",
    "stone",
    "hawkins",
    "dunn",
    "perkins",
    "hudson",
    "spencer",
    "gardner",
    "stephens",
    "payne",
    "pierce",
    "berry",
    "matthews",
    "arnold",
    "wagner",
    "willis",
    "ray",
    "watkins",
    "olson",
    "carroll",
    "duncan",
    "snyder",
    "hart",
    "cunningham",
    "bradley",
    "lane",
    "andrews",
    "ruiz",
    "harper",
    "fox",
    "riley",
    "armstrong",
    "carpenter",
    "weaver",
    "greene",
    "lawrence",
    "elliott",
    "chavez",
    "sims",
    "austin",
    "peters",
    "kelley",
    "franklin",
    "lawson",
    "fields",
    "gutierrez",
    "ryan",
    "schmidt",
    "carr",
    "vasquez",
    "castillo",
    "wheeler",
    "chapman",
    "oliver",
    "montgomery",
    "richards",
    "williamson",
    "johnston",
    "banks",
    "meyer",
    "bishop",
    "mccoy",
    "howell",
    "alvarez",
    "morrison",
    "hansen",
    "fernandez",
    "garza",
    "harvey",
    "little",
    "burton",
    "stanley",
    "nguyen",
    "george",
    "jacobs",
    "reid",
    "kim",
    "fuller",
    "lynch",
    "dean",
    "gilbert",
    "garrett",
    "romero",
    "welch",
    "larson",
    "frazier",
    "burke",
    "hanson",
    "day",
    "mendoza",
    "moreno",
    "bowman",
    "medina",
    "fowler",
    "brewer",
    "hoffman",
    "carlson",
    "silva",
    "pearson",
    "holland",
    "douglas",
    "fleming",
    "jensen",
    "vargas",
    "byrd",
    "davidson",
    "hopkins",
    "may",
    "terry",
    "herrera",
    "wade",
    "soto",
    "walters",
    "curtis",
    "neal",
    "caldwell",
    "lowe",
    "jennings",
    "barnett",
    "graves",
    "jimenez",
    "horton",
    "shelton",
    "barrett",
    "obrien",
    "castro",
    "sutton",
    "gregory",
    "mckinney",
    "lucas",
    "miles",
    "craig",
    "rodriquez",
    "chambers",
    "holt",
    "lambert",
    "fletcher",
    "watts",
    "bates",
    "hale",
    "rhodes",
    "pena",
    "beck",
    "newman",
] as const;

export const femaleNames = [
    "james",
    "john",
    "robert",
    "michael",
    "william",
    "david",
    "richard",
    "charles",
    "joseph",
    "thomas",
    "christopher",
    "daniel",
    "paul",
    "mark",
    "donald",
    "george",
    "kenneth",
    "steven",
    "edward",
    "brian",
    "ronald",
    "anthony",
    "kevin",
    "jason",
    "matthew",
    "gary",
    "timothy",
    "jose",
    "larry",
    "jeffrey",
    "frank",
    "scott",
    "eric",
    "stephen",
    "andrew",
    "raymond",
    "gregory",
    "joshua",
    "jerry",
    "dennis",
    "walter",
    "patrick",
    "peter",
    "harold",
    "douglas",
    "henry",
    "carl",
    "arthur",
    "ryan",
    "roger",
    "joe",
    "juan",
    "jack",
    "albert",
    "jonathan",
    "justin",
    "terry",
    "gerald",
    "keith",
    "samuel",
    "willie",
    "ralph",
    "lawrence",
    "nicholas",
    "roy",
    "benjamin",
    "bruce",
    "brandon",
    "adam",
    "harry",
    "fred",
    "wayne",
    "billy",
    "steve",
    "louis",
    "jeremy",
    "aaron",
    "randy",
    "howard",
    "eugene",
    "carlos",
    "russell",
    "bobby",
    "victor",
    "martin",
    "ernest",
    "phillip",
    "todd",
    "jesse",
    "craig",
    "alan",
    "shawn",
    "clarence",
    "sean",
    "philip",
    "chris",
    "johnny",
    "earl",
    "jimmy",
    "antonio",
    "danny",
    "bryan",
    "tony",
    "luis",
    "mike",
    "stanley",
    "leonard",
    "nathan",
    "dale",
    "manuel",
    "rodney",
    "curtis",
    "norman",
    "allen",
    "marvin",
    "vincent",
    "glenn",
    "jeffery",
    "travis",
    "jeff",
    "chad",
    "jacob",
    "lee",
    "melvin",
    "alfred",
    "kyle",
    "francis",
    "bradley",
    "jesus",
    "herbert",
    "frederick",
    "ray",
    "joel",
    "edwin",
    "don",
    "eddie",
    "ricky",
    "troy",
    "randall",
    "barry",
    "alexander",
    "bernard",
    "mario",
    "leroy",
    "francisco",
    "marcus",
    "micheal",
    "theodore",
    "clifford",
    "miguel",
    "oscar",
    "jay",
    "jim",
    "tom",
    "calvin",
    "alex",
    "jon",
    "ronnie",
    "bill",
    "lloyd",
    "tommy",
    "leon",
    "derek",
    "warren",
    "darrell",
    "jerome",
    "floyd",
    "leo",
    "alvin",
    "tim",
    "wesley",
    "gordon",
    "dean",
    "greg",
    "jorge",
    "dustin",
    "pedro",
    "derrick",
    "dan",
    "lewis",
    "zachary",
    "corey",
    "herman",
    "maurice",
    "vernon",
    "roberto",
    "clyde",
    "glen",
    "hector",
    "shane",
    "ricardo",
    "sam",
    "rick",
    "lester",
    "brent",
    "ramon",
    "charlie",
    "tyler",
    "gilbert",
    "gene",
    "marc",
    "reginald",
    "ruben",
    "brett",
    "angel",
    "nathaniel",
    "rafael",
    "leslie",
    "edgar",
    "milton",
    "raul",
    "ben",
    "chester",
    "cecil",
    "duane",
    "franklin",
    "andre",
    "elmer",
    "brad",
    "gabriel",
    "ron",
    "mitchell",
    "roland",
    "arnold",
    "harvey",
    "jared",
    "adrian",
    "karl",
    "cory",
    "claude",
    "erik",
    "darryl",
    "jamie",
    "neil",
    "jessie",
    "christian",
    "javier",
    "fernando",
    "clinton",
    "ted",
    "mathew",
    "tyrone",
    "darren",
    "lonnie",
    "lance",
    "cody",
    "julio",
    "kelly",
    "kurt",
    "allan",
    "nelson",
    "guy",
    "clayton",
    "hugh",
    "max",
    "dwayne",
    "dwight",
    "armando",
    "felix",
    "jimmie",
    "everett",
    "jordan",
    "ian",
    "wallace",
    "ken",
    "bob",
    "jaime",
    "casey",
    "alfredo",
    "alberto",
    "dave",
    "ivan",
    "johnnie",
    "sidney",
    "byron",
    "julian",
    "isaac",
    "morris",
    "clifton",
    "willard",
    "daryl",
    "ross",
    "virgil",
    "andy",
    "marshall",
    "salvador",
    "perry",
    "kirk",
    "sergio",
    "marion",
    "tracy",
    "seth",
    "kent",
    "terrance",
    "rene",
    "eduardo",
    "terrence",
    "enrique",
    "freddie",
    "wade",
] as const;

export const femaleLastNames = [
    "smith",
    "johnson",
    "williams",
    "jones",
    "brown",
    "davis",
    "miller",
    "wilson",
    "moore",
    "taylor",
    "anderson",
    "thomas",
    "jackson",
    "white",
    "harris",
    "martin",
    "thompson",
    "garcia",
    "martinez",
    "robinson",
    "clark",
    "rodriguez",
    "lewis",
    "lee",
    "walker",
    "hall",
    "allen",
    "young",
    "hernandez",
    "king",
    "wright",
    "lopez",
    "hill",
    "scott",
    "green",
    "adams",
    "baker",
    "gonzalez",
    "nelson",
    "carter",
    "mitchell",
    "perez",
    "roberts",
    "turner",
    "phillips",
    "campbell",
    "parker",
    "evans",
    "edwards",
    "collins",
    "stewart",
    "sanchez",
    "morris",
    "rogers",
    "reed",
    "cook",
    "morgan",
    "bell",
    "murphy",
    "bailey",
    "rivera",
    "cooper",
    "richardson",
    "cox",
    "howard",
    "ward",
    "torres",
    "peterson",
    "gray",
    "ramirez",
    "james",
    "watson",
    "brooks",
    "kelly",
    "sanders",
    "price",
    "bennett",
    "wood",
    "barnes",
    "ross",
    "henderson",
    "coleman",
    "jenkins",
    "perry",
    "powell",
    "long",
    "patterson",
    "hughes",
    "flores",
    "washington",
    "butler",
    "simmons",
    "foster",
    "gonzales",
    "bryant",
    "alexander",
    "russell",
    "griffin",
    "diaz",
    "hayes",
    "myers",
    "ford",
    "hamilton",
    "graham",
    "sullivan",
    "wallace",
    "woods",
    "cole",
    "west",
    "jordan",
    "owens",
    "reynolds",
    "fisher",
    "ellis",
    "harrison",
    "gibson",
    "mcdonald",
    "cruz",
    "marshall",
    "ortiz",
    "gomez",
    "murray",
    "freeman",
    "wells",
    "webb",
    "simpson",
    "stevens",
    "tucker",
    "porter",
    "hunter",
    "hicks",
    "crawford",
    "henry",
    "boyd",
    "mason",
    "morales",
    "kennedy",
    "warren",
    "dixon",
    "ramos",
    "reyes",
    "burns",
    "gordon",
    "shaw",
    "holmes",
    "rice",
    "robertson",
    "hunt",
    "black",
    "daniels",
    "palmer",
    "mills",
    "nichols",
    "grant",
    "knight",
    "ferguson",
    "rose",
    "stone",
    "hawkins",
    "dunn",
    "perkins",
    "hudson",
    "spencer",
    "gardner",
    "stephens",
    "payne",
    "pierce",
    "berry",
    "matthews",
    "arnold",
    "wagner",
    "willis",
    "ray",
    "watkins",
    "olson",
    "carroll",
    "duncan",
    "snyder",
    "hart",
    "cunningham",
    "bradley",
    "lane",
    "andrews",
    "ruiz",
    "harper",
    "fox",
    "riley",
    "armstrong",
    "carpenter",
    "weaver",
    "greene",
    "lawrence",
    "elliott",
    "chavez",
    "sims",
    "austin",
    "peters",
    "kelley",
    "franklin",
    "lawson",
    "fields",
    "gutierrez",
    "ryan",
    "schmidt",
    "carr",
    "vasquez",
    "castillo",
    "wheeler",
    "chapman",
    "oliver",
    "montgomery",
    "richards",
    "williamson",
    "johnston",
    "banks",
    "meyer",
    "bishop",
    "mccoy",
    "howell",
    "alvarez",
    "morrison",
    "hansen",
    "fernandez",
    "garza",
    "harvey",
    "little",
    "burton",
    "stanley",
    "nguyen",
    "george",
    "jacobs",
    "reid",
    "kim",
    "fuller",
    "lynch",
    "dean",
    "gilbert",
    "garrett",
    "romero",
    "welch",
    "larson",
    "frazier",
    "burke",
    "hanson",
    "day",
    "mendoza",
    "moreno",
    "bowman",
    "medina",
    "fowler",
    "brewer",
    "hoffman",
    "carlson",
    "silva",
    "pearson",
    "holland",
    "douglas",
    "fleming",
    "jensen",
    "vargas",
    "byrd",
    "davidson",
    "hopkins",
    "may",
    "terry",
    "herrera",
    "wade",
    "soto",
    "walters",
    "curtis",
    "neal",
    "caldwell",
    "lowe",
    "jennings",
    "barnett",
    "graves",
    "jimenez",
    "horton",
    "shelton",
    "barrett",
    "obrien",
    "castro",
    "sutton",
    "gregory",
    "mckinney",
    "lucas",
    "miles",
    "craig",
    "rodriquez",
    "chambers",
    "holt",
    "lambert",
    "fletcher",
    "watts",
    "bates",
    "hale",
    "rhodes",
    "pena",
    "beck",
    "newman",
] as const;

//////////////////////////////////////////////////////////////////

/**
 * How to decode a Bitizen's attributes from Nimblebit's ordered list format.
 *
 * @since 1.0.0
 * @category Schemas
 */
export const BitizenAttributes = Schema.suspend(() => {
    class Skill extends Function.pipe(Schema.Int, Schema.between(0, 9)) {}
    class BirthDay extends Function.pipe(Schema.Int, Schema.between(1, 31)) {}
    class BirthMonth extends Function.pipe(Schema.Int, Schema.between(1, 31)) {}
    class BooleanFromOneOrZero extends Schema.transformLiterals(["0", false], ["1", true]) {}
    class IndexFromString extends Schema.compose(Schema.NumberFromString, Schema.NonNegativeInt) {}

    const to = Schema.Struct({
        $unknown: Schema.Array(Schema.String),
        gender: Schema.Literal("female", "male"),
        name: Schema.String,
        birthday: Schema.Tuple(BirthMonth, BirthDay),
        designColors: Schema.Struct({
            pantColor: Schema.typeSchema(NimblebitSchema.UnityColor),
            shirtColor: Schema.typeSchema(NimblebitSchema.UnityColor),
            skinColorIndex: Schema.NonNegativeInt,
            hairColorIndex: Schema.NonNegativeInt,
            shoeColorIndex: Schema.NonNegativeInt,
        }),
        accessories: Schema.Struct({
            tie: Schema.EitherFromSelf({
                left: Schema.typeSchema(NimblebitSchema.UnityColor),
                right: Schema.typeSchema(NimblebitSchema.UnityColor),
            }),
            earrings: Schema.EitherFromSelf({
                left: Schema.typeSchema(NimblebitSchema.UnityColor),
                right: Schema.typeSchema(NimblebitSchema.UnityColor),
            }),
            glasses: Schema.EitherFromSelf({ left: Schema.NonNegativeInt, right: Schema.NonNegativeInt }),
            hairAccessory: Schema.EitherFromSelf({ left: Schema.NonNegativeInt, right: Schema.NonNegativeInt }),
            hat: Schema.EitherFromSelf({
                left: Schema.Struct({
                    color: Schema.typeSchema(NimblebitSchema.UnityColor),
                    index: Schema.NonNegativeInt,
                }),
                right: Schema.Struct({
                    color: Schema.typeSchema(NimblebitSchema.UnityColor),
                    index: Schema.NonNegativeInt,
                    gender: Schema.Literal("female", "male", "bi"),
                }),
            }),
        }),
        skills: Schema.Struct({
            food: Skill,
            retail: Skill,
            service: Skill,
            creative: Skill,
            recreation: Skill,
        }),
    });

    const from = NimblebitSchema.parseNimblebitOrderedList([
        { property: "male", schema: BooleanFromOneOrZero },
        { property: "firstNameIndex", schema: IndexFromString },
        { property: "lastNameIndex", schema: IndexFromString },
        { property: "birthMonth", schema: Schema.compose(Schema.NumberFromString, BirthMonth) },
        { property: "birthDay", schema: Schema.compose(Schema.NumberFromString, BirthDay) },
        { property: "skinColorIndex", schema: IndexFromString }, // TODO: What do these index?
        { property: "hairColorIndex", schema: IndexFromString }, // TODO: What do these index?
        { property: "shoeColorIndex", schema: IndexFromString }, // TODO: What do these index?
        { property: "pantColor", schema: NimblebitSchema.UnityColor },
        { property: "shirtColor", schema: NimblebitSchema.UnityColor },
        { property: "hasGlasses", schema: BooleanFromOneOrZero },
        { property: "glassesIndex", schema: IndexFromString }, // TODO: What does this index
        { property: "hasTie", schema: BooleanFromOneOrZero },
        { property: "tieColor", schema: NimblebitSchema.UnityColor },
        { property: "hasHairAccessory", schema: BooleanFromOneOrZero },
        { property: "hairAccessoryIndex", schema: IndexFromString }, // TODO: What does this index
        { property: "hasBiHat", schema: BooleanFromOneOrZero },
        { property: "hasMaleHat", schema: BooleanFromOneOrZero },
        { property: "hasFemaleHat", schema: BooleanFromOneOrZero },
        { property: "hatIndex", schema: IndexFromString }, // TODO: What does this index
        { property: "hatColor", schema: NimblebitSchema.UnityColor },
        { property: "hasEarrings", schema: BooleanFromOneOrZero },
        { property: "earringsColor", schema: NimblebitSchema.UnityColor },
        { property: "skillFood", schema: Schema.compose(Schema.NumberFromString, Skill) },
        { property: "skillService", schema: Schema.compose(Schema.NumberFromString, Skill) },
        { property: "skillRecreation", schema: Schema.compose(Schema.NumberFromString, Skill) },
        { property: "skillRetail", schema: Schema.compose(Schema.NumberFromString, Skill) },
        { property: "skillCreative", schema: Schema.compose(Schema.NumberFromString, Skill) },
    ]);

    return Schema.transformOrFail(from, to, {
        encode: (
            custom: Schema.Schema.Encoded<typeof to>,
            _options: SchemaAST.ParseOptions,
            ast: SchemaAST.AST
        ): Effect.Effect<Schema.Schema.Type<typeof from>, ParseResult.ParseIssue, never> => {
            const isMale = custom.gender === "male";
            const [firstName, lastName] = custom.name.split(" ");

            const firstNameIndex = Function.pipe(
                isMale ? maleNames : femaleNames,
                Array.fromIterable,
                Array.findFirstIndex((name) => name === firstName)
            );

            const lastNameIndex = Function.pipe(
                isMale ? maleLastNames : femaleLastNames,
                Array.fromIterable,
                Array.findFirstIndex((name) => name === lastName)
            );

            if (Option.isNone(firstNameIndex) || Option.isNone(lastNameIndex)) {
                return ParseResult.fail(
                    new ParseResult.Type(
                        ast,
                        custom.name,
                        `Bitizen name ${custom.name} not found in internal lists, cannot encode`
                    )
                );
            }

            return ParseResult.succeed({
                male: isMale,
                firstNameIndex: firstNameIndex.value,
                lastNameIndex: lastNameIndex.value,
                birthMonth: custom.birthday[0],
                birthDay: custom.birthday[1],
                skinColorIndex: custom.designColors.skinColorIndex,
                hairColorIndex: custom.designColors.hairColorIndex,
                shoeColorIndex: custom.designColors.shoeColorIndex,
                pantColor: custom.designColors.pantColor,
                shirtColor: custom.designColors.shirtColor,
                hasGlasses: Either.isRight(custom.accessories.glasses),
                glassesIndex: Either.merge(custom.accessories.glasses),
                hasTie: Either.isRight(custom.accessories.tie),
                tieColor: Either.merge(custom.accessories.tie),
                hasHairAccessory: Either.isRight(custom.accessories.hairAccessory),
                hairAccessoryIndex: Either.merge(custom.accessories.hairAccessory),
                hasBiHat: Either.getOrElse(
                    Either.map(custom.accessories.hat, ({ gender }) => gender === "bi"),
                    Function.constFalse
                ),
                hasMaleHat: Either.getOrElse(
                    Either.map(custom.accessories.hat, ({ gender }) => gender === "male"),
                    Function.constFalse
                ),
                hasFemaleHat: Either.getOrElse(
                    Either.map(custom.accessories.hat, ({ gender }) => gender === "female"),
                    Function.constFalse
                ),
                hatIndex: Either.merge(custom.accessories.hat).index,
                hatColor: Either.merge(custom.accessories.hat).color,
                hasEarrings: Either.isRight(custom.accessories.earrings),
                earringsColor: Either.merge(custom.accessories.earrings),
                skillFood: custom.skills.food,
                skillService: custom.skills.service,
                skillRecreation: custom.skills.recreation,
                skillRetail: custom.skills.retail,
                skillCreative: custom.skills.creative,
                $unknown: custom.$unknown,
            });
        },
        decode: (
            nimblebit: Schema.Schema.Type<typeof from>,
            _options: SchemaAST.ParseOptions,
            _ast: SchemaAST.AST
        ): Effect.Effect<Schema.Schema.Encoded<typeof to>, ParseResult.ParseIssue, never> => {
            const gender = nimblebit.male ? "male" : "female";

            const firstName = Function.pipe(
                gender === "female" ? femaleNames : maleNames,
                Array.fromIterable,
                Array.get(nimblebit.firstNameIndex)
            );

            const lastName = Function.pipe(
                gender === "female" ? femaleLastNames : maleLastNames,
                Array.fromIterable,
                Array.get(nimblebit.lastNameIndex)
            );

            if (Option.isNone(firstName) || Option.isNone(lastName)) {
                return ParseResult.fail(
                    new ParseResult.Type(
                        _ast,
                        nimblebit,
                        `Bitizen name indexes ${nimblebit.firstNameIndex},${nimblebit.lastNameIndex} not found in internal lists, cannot decode`
                    )
                );
            }

            const tie = nimblebit.hasTie ? Either.right(nimblebit.tieColor) : Either.left(nimblebit.tieColor);
            const glasses = nimblebit.hasGlasses
                ? Either.right(nimblebit.glassesIndex)
                : Either.left(nimblebit.glassesIndex);
            const hairAccessory = nimblebit.hasHairAccessory
                ? Either.right(nimblebit.hairAccessoryIndex)
                : Either.left(nimblebit.hairAccessoryIndex);
            const earrings = nimblebit.hasEarrings
                ? Either.right(nimblebit.earringsColor)
                : Either.left(nimblebit.earringsColor);
            const hat =
                nimblebit.hasBiHat || nimblebit.hasMaleHat || nimblebit.hasFemaleHat
                    ? Either.right({
                          index: nimblebit.hatIndex,
                          color: nimblebit.hatColor,
                          gender: nimblebit.hasBiHat ? "bi" : nimblebit.hasMaleHat ? "male" : "female",
                      } as const)
                    : Either.left({
                          index: nimblebit.hatIndex,
                          color: nimblebit.hatColor,
                      } as const);

            return ParseResult.succeed({
                $unknown: nimblebit.$unknown,
                gender,
                name: `${firstName.value} ${lastName.value}`,
                birthday: [nimblebit.birthMonth, nimblebit.birthDay],
                designColors: {
                    skinColorIndex: nimblebit.skinColorIndex,
                    hairColorIndex: nimblebit.hairColorIndex,
                    shoeColorIndex: nimblebit.shoeColorIndex,
                    pantColor: nimblebit.pantColor,
                    shirtColor: nimblebit.shirtColor,
                },
                accessories: {
                    tie,
                    glasses,
                    hairAccessory,
                    earrings,
                    hat,
                },
                skills: {
                    food: nimblebit.skillFood,
                    service: nimblebit.skillService,
                    recreation: nimblebit.skillRecreation,
                    retail: nimblebit.skillRetail,
                    creative: nimblebit.skillCreative,
                },
            });
        },
    });
});

/**
 * How to decode a Bitizen from Nimblebit's object format.
 *
 * @since 1.0.0
 * @category Schemas
 */
export const Bitizen = NimblebitSchema.parseNimblebitObject(
    Schema.Struct({
        homeIndex: Schema.NumberFromString.pipe(
            Schema.compose(Schema.Int),
            Schema.propertySignature,
            Schema.fromKey("h")
        ),
        workIndex: Schema.NumberFromString.pipe(
            Schema.compose(Schema.Int),
            Schema.propertySignature,
            Schema.fromKey("w")
        ),
        placedDreamJob: Schema.transformLiterals(["0", false], ["1", true]).pipe(
            Schema.propertySignature,
            Schema.fromKey("d")
        ),
        dreamJobIndex: Schema.NumberFromString.pipe(
            Schema.compose(Schema.Int),
            Schema.propertySignature,
            Schema.fromKey("j")
        ),
        costume: Schema.requiredToOptional(
            Schema.Union(Schema.Literal(""), Schema.Literal(...Record.keys(Costumes.costumes)), Schema.String),
            Schema.Union(Schema.Literal(...Record.keys(Costumes.costumes)), Schema.String),
            {
                encode: Option.getOrElse(() => "" as const),
                decode: (costume) => (costume === "" ? Option.none() : Option.some(costume)),
            }
        ).pipe(Schema.fromKey("c")),
        vip: Schema.Union(
            Schema.transformLiterals(
                ["0", "None"],
                ["1", "Engineer"],
                ["2", "TravelAgent"],
                ["3", "Deliveryman"],
                ["4", "BigSpender"],
                ["5", "Celebrity"],
                ["6", "GiftBit"]
                // TODO: Investigate remaining missing entries
            ),
            Schema.compose(Schema.NumberFromString, Schema.Int)
        ).pipe(Schema.propertySignature, Schema.fromKey("v")),
        customName: Schema.String.pipe(Schema.optional, Schema.fromKey("cn")),
        pet: Schema.Literal(...Record.keys(Pets.pets)).pipe(Schema.optional, Schema.fromKey("p")),
        attributes: BitizenAttributes.pipe(Schema.propertySignature, Schema.fromKey("BA")),
    })
);
